import{r,j as e,t as x,h as a,m as h,d as j,g as k,f as y,i as S,G as g,b,R as v,s as M}from"./index-CeQ_7HA2.js";import{P as L}from"./page-header-YNPf6UAV.js";import{M as C,E,D as O}from"./delete-material-form-CTzLSbpV.js";import{P}from"./plus-DoolWeGV.js";import{E as w}from"./eye-CZSEa0nN.js";import{P as D}from"./form-dialog-DtrkgT1B.js";import"./geo-input-BBVxjaZv.js";import"./input-DRQBVYz2.js";import"./scroll-area-Mw2U67h-.js";import"./index-BdQq_4o_.js";import"./minus-CARIRyBU.js";import"./file-text-CFd6p5Bn.js";function N({trigger:n,onSuccess:l}){const[f,i]=r.useState(!1),[c,m]=r.useState(!1),[t,u]=r.useState({title:"",description:"",formula:"",example:"",youtubeLinks:[],imageLinks:[]}),p=async()=>{if(!t.title||!t.description||!t.formula||!t.example){x.error("Semua field harus diisi!");return}m(!0);try{const d={...t,title:a.encode(t.title),description:a.encode(t.description),formula:a.encode(t.formula),example:a.encode(t.example),youtubeLinks:t.youtubeLinks.map(o=>a.encode(o)),imageLinks:t.imageLinks.map(o=>a.encode(o))},s=await h.createMaterial(d);x.success(`Materi "${a.decode(s.material.title)}" berhasil ditambahkan!`),u({title:"",description:"",formula:"",example:"",youtubeLinks:[],imageLinks:[]}),l(),i(!1)}catch(d){x.error("Gagal menambahkan: "+d.message)}finally{m(!1)}};return e.jsx("div",{children:e.jsx(C,{isProcessing:c,values:t,setValues:u,onClick:p,trigger:n,open:f,onOpenChange:i})})}function $(){const n=j(),l=k(),{materials:f}=y.useLoaderData(),[i,c]=r.useState(null),[m,t]=r.useState(!1),[u,p]=r.useState(!1),d=S();return e.jsxs("div",{className:"flex flex-col flex-grow px-4 md:px-16 space-y-4",children:[e.jsx(L,{title:"Materi",description:"Pelajari konsep-konsep transformasi geometri",additionalButtons:l?.user.role==="admin"&&e.jsx(N,{onSuccess:()=>n.invalidate(),trigger:e.jsxs(g,{variant:"secondary",className:"flex-1",children:[e.jsx(P,{})," Tambah Materi"]})}),colorScheme:"yellow"}),e.jsx("div",{className:"flex-grow grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:f.map((s,o)=>e.jsx(b,{icon:e.jsx("span",{className:"font-bold text-2xl",children:o+1}),title:a.decode(s.title),content:e.jsx("p",{className:"line-clamp-3 break-words overflow-hidden",children:a.decode(s.description)}),footer:e.jsxs("div",{className:"flex flex-col items-center justify-between gap-2",children:[e.jsxs(g,{to:v.materials.materialDetail(s._id),onClick:async()=>{l?.user.role==="student"&&await M.recordStatistic({type:"material",data:{title:s.title,material:s._id}})},variant:"primary",children:[e.jsx(w,{})," Lihat"]}),l?.user.role==="admin"&&e.jsxs(g,{onClick:()=>{c(s),t(!0)},variant:"secondary",children:[e.jsx(D,{})," Edit"]})]}),"data-aos-delay":d?0:o%4*100},o))}),i&&e.jsx(E,{open:m,setOpen:t,material:i,onSuccess:()=>{c(null),n.invalidate()},onDeleteClick:()=>{p(!0)}}),i&&e.jsx(O,{open:u,onOpenChange:()=>{p(!1)},material:i,onSuccess:()=>{c(null),n.invalidate()}})]})}export{$ as component};
